{"version":3,"sources":["webpack:///./node_modules/wicket/wicket.js","webpack:///./src/assets/images/bus.png","webpack:///./src/assets/images/stop.png","webpack:///./src/views/BusDrivingMap.vue","webpack:///./src/views/BusDrivingMap.vue?00a1","webpack:///./src/views/BusDrivingMap.vue?4c26"],"names":["root","factory","this","beginsWith","endsWith","Wkt","obj","_wrapped","str","sub","substring","length","delimiter","isArray","constructor","Array","trim","initializer","wrapVertices","regExes","_stripWhitespaceAndParens","fullStr","trimmed","noParens","replace","components","undefined","read","fromObject","prototype","isCollection","type","slice","sameCoords","a","b","x","y","result","hasOwnProperty","fromJson","deconstruct","call","isRectangle","toObject","config","construct","properties","toString","write","i","j","k","coords","iring","oring","toLowerCase","geometry","coordinates","push","toJson","cs","json","ring","rings","s","ogcTypes","exec","toUpperCase","join","bbox","concat","merge","wkt","prefix","TypeError","matches","typeStr","base","ingest","apply","crudeJson","test","console","log","name","message","JSON","parse","pieces","data","extract","point","String","multipoint","parts","linestring","multilinestring","polygon","multipolygon","box","geometrycollection","split","spaces","parseFloat","numeric","points","comma","multipoints","line","lines","doubleParenComma","parenComma","subcomponents","filter","n","x_cord","y_cord","polygons","module","exports","class","id","navbar-style","navbarStyle","routeData","$refs","timetableModal","show","routeName","DepartureStopNameZh","DestinationStopNameZh","busDirection","hasBothDirection","busDirectionHandler","tempRealtimeData","stop","key","StopID","stopName","estimateTime","data-bs-toggle","data-bs-target","aria-expanded","aria-controls","collapseShow","bus","ref","BreadcrumbBar","TimetableModal","city","busTimetables","busRoute","busLocation","busStop","tempStops","realtimeData","map","routeLayer","stopLayer","busLayer","computed","item","Direction","newData","StopName","Zh_tw","stopUID","StopUID","stopSequence","StopSequence","plateNumb","forEach","PlateNumb","options","day","month","year","hour","minute","hour12","timeZone","NextBusTime","Date","toLocaleTimeString","StopStatus","time","Math","floor","EstimateTime","watch","drawRoute","drawStop","drawBus","inject","methods","initialMap","zoomControl","setView","tileLayer","attribution","minZoom","maxZoom","subdomains","accessToken","addTo","getRouteData","getShapeData","getStop","getRealtimeData","getBusLocation","getBusTimetable","axios","method","url","headers","getAuthorizationHeader","then","res","find","RouteName","go","back","removeLayer","geo","Geometry","wicket","geojsonFeature","geoJSON","style","color","weight","fitBounds","getBounds","icon","iconUrl","iconSize","layerGroup","lat","BusPosition","PositionLat","lon","PositionLon","marker","title","opacity","setZIndexOffset","Stops","StopPosition","Timetables","newTimetables","subRouteName","SubRouteName","direction","timetable","ServiceDay","StopTimes","DepartureTime","index","departureTime","indexOf","serviceDay","days","Object","keys","sort","holidayTimetable","Saturday","Sunday","holiday","commonTimetable","Monday","Tuesday","Wednesday","Thursday","Friday","common","Frequencys","newFrequencys","frequency","timePeriod","StartTime","EndTime","startTime","endTime","minHeadwayMins","MinHeadwayMins","maxHeadwayMins","MaxHeadwayMins","holidayFrequency","commonFrequency","created","emitter","emit","$route","query","mounted","__exports__","render"],"mappings":"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","file":"js/chunk-9a687634.b08a7c1c.js","sourcesContent":["/** @license\n *\n *  Copyright (C) 2012 K. Arthur Endsley (kaendsle@mtu.edu)\n *  Michigan Tech Research Institute (MTRI)\n *  3600 Green Court, Suite 100, Ann Arbor, MI, 48105\n *\n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU General Public License as published by\n *  the Free Software Foundation, either version 3 of the License, or\n *  (at your option) any later version.\n *\n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU General Public License for more details.\n *\n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n(function (root, factory) {\n\n    if (typeof define === \"function\" && define.amd) {\n        // AMD (+ global for extensions)\n        define(function () {\n            return factory();\n        });\n    } else if (typeof module !== 'undefined' && typeof exports === \"object\") {\n        // CommonJS\n        module.exports = factory();\n    } else {\n        // Browser\n        root.Wkt = factory();\n    }\n}(this, function () {\n\n\n    var beginsWith, endsWith, root, Wkt;\n\n    // Establish the root object, window in the browser, or exports on the server\n    root = this;\n\n    /**\n     * @desc The Wkt namespace.\n     * @property    {String}    delimiter   - The default delimiter for separating components of atomic geometry (coordinates)\n     * @namespace\n     * @global\n     */\n    Wkt = function (obj) {\n        if (obj instanceof Wkt) return obj;\n        if (!(this instanceof Wkt)) return new Wkt(obj);\n        this._wrapped = obj;\n    };\n\n\n\n    /**\n     * Returns true if the substring is found at the beginning of the string.\n     * @param   str {String}    The String to search\n     * @param   sub {String}    The substring of interest\n     * @return      {Boolean}\n     * @private\n     */\n    beginsWith = function (str, sub) {\n        return str.substring(0, sub.length) === sub;\n    };\n\n    /**\n     * Returns true if the substring is found at the end of the string.\n     * @param   str {String}    The String to search\n     * @param   sub {String}    The substring of interest\n     * @return      {Boolean}\n     * @private\n     */\n    endsWith = function (str, sub) {\n        return str.substring(str.length - sub.length) === sub;\n    };\n\n    /**\n     * The default delimiter for separating components of atomic geometry (coordinates)\n     * @ignore\n     */\n    Wkt.delimiter = ' ';\n\n    /**\n     * Determines whether or not the passed Object is an Array.\n     * @param   obj {Object}    The Object in question\n     * @return      {Boolean}\n     * @member Wkt.isArray\n     * @method\n     */\n    Wkt.isArray = function (obj) {\n        return !!(obj && obj.constructor === Array);\n    };\n\n    /**\n     * Removes given character String(s) from a String.\n     * @param   str {String}    The String to search\n     * @param   sub {String}    The String character(s) to trim\n     * @return      {String}    The trimmed string\n     * @member Wkt.trim\n     * @method\n     */\n    Wkt.trim = function (str, sub) {\n        sub = sub || ' '; // Defaults to trimming spaces\n        // Trim beginning spaces\n        while (beginsWith(str, sub)) {\n            str = str.substring(1);\n        }\n        // Trim ending spaces\n        while (endsWith(str, sub)) {\n            str = str.substring(0, str.length - 1);\n        }\n        return str;\n    };\n\n    /**\n     * An object for reading WKT strings and writing geographic features\n     * @constructor this.Wkt.Wkt\n     * @param   initializer {String}    An optional WKT string for immediate read\n     * @property            {Array}     components      - Holder for atomic geometry objects (internal representation of geometric components)\n     * @property            {String}    delimiter       - The default delimiter for separating components of atomic geometry (coordinates)\n     * @property            {Object}    regExes         - Some regular expressions copied from OpenLayers.Format.WKT.js\n     * @property            {String}    type            - The Well-Known Text name (e.g. 'point') of the geometry\n     * @property            {Boolean}   wrapVerticies   - True to wrap vertices in MULTIPOINT geometries; If true: MULTIPOINT((30 10),(10 30),(40 40)); If false: MULTIPOINT(30 10,10 30,40 40)\n     * @return              {this.Wkt.Wkt}\n     * @memberof Wkt\n     */\n    Wkt.Wkt = function (initializer) {\n\n        /**\n         * The default delimiter between X and Y coordinates.\n         * @ignore\n         */\n        this.delimiter = Wkt.delimiter || ' ';\n\n        /**\n         * Configuration parameter for controlling how Wicket seralizes\n         * MULTIPOINT strings. Examples; both are valid WKT:\n         * If true: MULTIPOINT((30 10),(10 30),(40 40))\n         * If false: MULTIPOINT(30 10,10 30,40 40)\n         * @ignore\n         */\n        this.wrapVertices = true;\n\n        /**\n         * Some regular expressions copied from OpenLayers.Format.WKT.js\n         * @ignore\n         */\n        this.regExes = {\n            'typeStr': /^\\s*(\\w+)\\s*\\(\\s*(.*)\\s*\\)\\s*$/,\n            'spaces': /\\s+|\\+/, // Matches the '+' or the empty space\n            'numeric': /-*\\d+(\\.*\\d+)?/,\n            'comma': /\\s*,\\s*/,\n            'parenComma': /\\)\\s*,\\s*\\(/,\n            'coord': /-*\\d+\\.*\\d+ -*\\d+\\.*\\d+/, // e.g. \"24 -14\"\n            'doubleParenComma': /\\)\\s*\\)\\s*,\\s*\\(\\s*\\(/,\n            'ogcTypes': /^(multi)?(point|line|polygon|box)?(string)?$/i, // Captures e.g. \"Multi\",\"Line\",\"String\"\n            'crudeJson': /^{.*\"(type|coordinates|geometries|features)\":.*}$/ // Attempts to recognize JSON strings\n        };\n\n        /**\n         * Strip any whitespace and parens from front and back.\n         * This is the equivalent of s/^\\s*\\(?(.*)\\)?\\s*$/$1/ but without the risk of catastrophic backtracking.\n         * @param   str {String}\n         */\n        this._stripWhitespaceAndParens = function (fullStr) {\n            var trimmed = fullStr.trim();\n            var noParens = trimmed.replace(/^\\(?(.*?)\\)?$/, '$1');\n            return noParens;\n        };\n\n        /**\n         * The internal representation of geometry--the \"components\" of geometry.\n         * @ignore\n         */\n        this.components = undefined;\n\n        // An initial WKT string may be provided\n        if (initializer && typeof initializer === 'string') {\n            this.read(initializer);\n        } else if (initializer && typeof initializer !== undefined) {\n            this.fromObject(initializer);\n        }\n\n    };\n\n\n\n    /**\n     * Returns true if the internal geometry is a collection of geometries.\n     * @return  {Boolean}   Returns true when it is a collection\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.isCollection = function () {\n        switch (this.type.slice(0, 5)) {\n            case 'multi':\n                // Trivial; any multi-geometry is a collection\n                return true;\n            case 'polyg':\n                // Polygons with holes are \"collections\" of rings\n                return true;\n            default:\n                // Any other geometry is not a collection\n                return false;\n        }\n    };\n\n    /**\n     * Compares two x,y coordinates for equality.\n     * @param   a   {Object}    An object with x and y properties\n     * @param   b   {Object}    An object with x and y properties\n     * @return      {Boolean}\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.sameCoords = function (a, b) {\n        return (a.x === b.x && a.y === b.y);\n    };\n\n    /**\n     * Sets internal geometry (components) from framework geometry (e.g.\n     * Google Polygon objects or google.maps.Polygon).\n     * @param   obj {Object}    The framework-dependent geometry representation\n     * @return      {this.Wkt.Wkt}   The object itself\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.fromObject = function (obj) {\n        var result;\n\n        if (obj.hasOwnProperty('type') && obj.hasOwnProperty('coordinates')) {\n            result = this.fromJson(obj);\n        } else {\n            result = this.deconstruct.call(this, obj);\n        }\n\n        this.components = result.components;\n        this.isRectangle = result.isRectangle || false;\n        this.type = result.type;\n        return this;\n    };\n\n    /**\n     * Creates external geometry objects based on a plug-in framework's\n     * construction methods and available geometry classes.\n     * @param   config  {Object}    An optional framework-dependent properties specification\n     * @return          {Object}    The framework-dependent geometry representation\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.toObject = function (config) {\n        var obj = this.construct[this.type].call(this, config);\n        // Don't assign the \"properties\" property to an Array\n        if (typeof obj === 'object' && !Wkt.isArray(obj)) {\n            obj.properties = this.properties;\n        }\n        return obj;\n    };\n\n    /**\n     * Returns the WKT string representation; the same as the write() method.\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.toString = function (config) {\n        return this.write();\n    };\n\n    /**\n     * Parses a JSON representation as an Object.\n     * @param\tobj\t{Object}\tAn Object with the GeoJSON schema\n     * @return\t{this.Wkt.Wkt}\tThe object itself\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.fromJson = function (obj) {\n        var i, j, k, coords, iring, oring;\n\n        this.type = obj.type.toLowerCase();\n        this.components = [];\n        if (obj.hasOwnProperty('geometry')) { //Feature\n            this.fromJson(obj.geometry);\n            this.properties = obj.properties;\n            return this;\n        }\n        coords = obj.coordinates;\n\n        if (!Wkt.isArray(coords[0])) { // Point\n            this.components.push({\n                x: coords[0],\n                y: coords[1]\n            });\n\n        } else {\n\n            for (i in coords) {\n                if (coords.hasOwnProperty(i)) {\n\n                    if (!Wkt.isArray(coords[i][0])) { // LineString\n\n                        if (this.type === 'multipoint') { // MultiPoint\n                            this.components.push([{\n                                x: coords[i][0],\n                                y: coords[i][1]\n                            }]);\n\n                        } else {\n                            this.components.push({\n                                x: coords[i][0],\n                                y: coords[i][1]\n                            });\n\n                        }\n\n                    } else {\n\n                        oring = [];\n                        for (j in coords[i]) {\n                            if (coords[i].hasOwnProperty(j)) {\n\n                                if (!Wkt.isArray(coords[i][j][0])) {\n                                    oring.push({\n                                        x: coords[i][j][0],\n                                        y: coords[i][j][1]\n                                    });\n\n                                } else {\n\n                                    iring = [];\n                                    for (k in coords[i][j]) {\n                                        if (coords[i][j].hasOwnProperty(k)) {\n\n                                            iring.push({\n                                                x: coords[i][j][k][0],\n                                                y: coords[i][j][k][1]\n                                            });\n\n                                        }\n                                    }\n\n                                    oring.push(iring);\n\n                                }\n\n                            }\n                        }\n\n                        this.components.push(oring);\n                    }\n                }\n            }\n\n        }\n\n        return this;\n    };\n\n    /**\n     * Creates a JSON representation, with the GeoJSON schema, of the geometry.\n     * @return    {Object}    The corresponding GeoJSON representation\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.toJson = function () {\n        var cs, json, i, j, k, ring, rings;\n\n        cs = this.components;\n        json = {\n            coordinates: [],\n            type: (function () {\n                var i, type, s;\n\n                type = this.regExes.ogcTypes.exec(this.type).slice(1);\n                s = [];\n\n                for (i in type) {\n                    if (type.hasOwnProperty(i)) {\n                        if (type[i] !== undefined) {\n                            s.push(type[i].toLowerCase().slice(0, 1).toUpperCase() + type[i].toLowerCase().slice(1));\n                        }\n                    }\n                }\n\n                return s;\n            }.call(this)).join('')\n        }\n\n        // Wkt BOX type gets a special bbox property in GeoJSON\n        if (this.type.toLowerCase() === 'box') {\n            json.type = 'Polygon';\n            json.bbox = [];\n\n            for (i in cs) {\n                if (cs.hasOwnProperty(i)) {\n                    json.bbox = json.bbox.concat([cs[i].x, cs[i].y]);\n                }\n            }\n\n            json.coordinates = [\n                [\n                    [cs[0].x, cs[0].y],\n                    [cs[0].x, cs[1].y],\n                    [cs[1].x, cs[1].y],\n                    [cs[1].x, cs[0].y],\n                    [cs[0].x, cs[0].y]\n                ]\n            ];\n\n            return json;\n        }\n\n        // For the coordinates of most simple features\n        for (i in cs) {\n            if (cs.hasOwnProperty(i)) {\n\n                // For those nested structures\n                if (Wkt.isArray(cs[i])) {\n                    rings = [];\n\n                    for (j in cs[i]) {\n                        if (cs[i].hasOwnProperty(j)) {\n\n                            if (Wkt.isArray(cs[i][j])) { // MULTIPOLYGONS\n                                ring = [];\n\n                                for (k in cs[i][j]) {\n                                    if (cs[i][j].hasOwnProperty(k)) {\n                                        ring.push([cs[i][j][k].x, cs[i][j][k].y]);\n                                    }\n                                }\n\n                                rings.push(ring);\n\n                            } else { // POLYGONS and MULTILINESTRINGS\n\n                                if (cs[i].length > 1) {\n                                    rings.push([cs[i][j].x, cs[i][j].y]);\n\n                                } else { // MULTIPOINTS\n                                    rings = rings.concat([cs[i][j].x, cs[i][j].y]);\n                                }\n                            }\n                        }\n                    }\n\n                    json.coordinates.push(rings);\n\n                } else {\n                    if (cs.length > 1) { // For LINESTRING type\n                        json.coordinates.push([cs[i].x, cs[i].y]);\n\n                    } else { // For POINT type\n                        json.coordinates = json.coordinates.concat([cs[i].x, cs[i].y]);\n                    }\n                }\n\n            }\n        }\n\n        return json;\n    };\n\n    /**\n     * Absorbs the geometry of another this.Wkt.Wkt instance, merging it with its own,\n     * creating a collection (MULTI-geometry) based on their types, which must agree.\n     * For example, creates a MULTIPOLYGON from a POLYGON type merged with another\n     * POLYGON type, or adds a POLYGON instance to a MULTIPOLYGON instance.\n     * @param   wkt {String}    A Wkt.Wkt object\n     * @return\t{this.Wkt.Wkt}\tThe object itself\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.merge = function (wkt) {\n        var prefix = this.type.slice(0, 5);\n\n        if (this.type !== wkt.type) {\n            if (this.type.slice(5, this.type.length) !== wkt.type) {\n                throw TypeError('The input geometry types must agree or the calling this.Wkt.Wkt instance must be a multigeometry of the other');\n            }\n        }\n\n        switch (prefix) {\n\n            case 'point':\n                this.components = [this.components.concat(wkt.components)];\n                break;\n\n            case 'multi':\n                this.components = this.components.concat((wkt.type.slice(0, 5) === 'multi') ? wkt.components : [wkt.components]);\n                break;\n\n            default:\n                this.components = [\n                    this.components,\n                    wkt.components\n                ];\n                break;\n\n        }\n\n        if (prefix !== 'multi') {\n            this.type = 'multi' + this.type;\n        }\n        return this;\n    };\n\n    /**\n     * Reads a WKT string, validating and incorporating it.\n     * @param   str {String}    A WKT or GeoJSON string\n     * @return\t{this.Wkt.Wkt}\tThe object itself\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.read = function (str) {\n        var matches;\n        matches = this.regExes.typeStr.exec(str);\n        if (matches) {\n            this.type = matches[1].toLowerCase();\n            this.base = matches[2];\n            if (this.ingest[this.type]) {\n                this.components = this.ingest[this.type].apply(this, [this.base]);\n            }\n\n        } else {\n            if (this.regExes.crudeJson.test(str)) {\n                if (typeof JSON === 'object' && typeof JSON.parse === 'function') {\n                    this.fromJson(JSON.parse(str));\n\n                } else {\n                    console.log('JSON.parse() is not available; cannot parse GeoJSON strings');\n                    throw {\n                        name: 'JSONError',\n                        message: 'JSON.parse() is not available; cannot parse GeoJSON strings'\n                    };\n                }\n\n            } else {\n                console.log('Invalid WKT string provided to read()');\n                throw {\n                    name: 'WKTError',\n                    message: 'Invalid WKT string provided to read()'\n                };\n            }\n        }\n\n        return this;\n    }; // eo readWkt\n\n    /**\n     * Writes a WKT string.\n     * @param   components  {Array}     An Array of internal geometry objects\n     * @return              {String}    The corresponding WKT representation\n     * @memberof this.Wkt.Wkt\n     * @method\n     */\n    Wkt.Wkt.prototype.write = function (components) {\n        var i, pieces, data;\n\n        components = components || this.components;\n\n        pieces = [];\n\n        pieces.push(this.type.toUpperCase() + '(');\n\n        for (i = 0; i < components.length; i += 1) {\n            if (this.isCollection() && i > 0) {\n                pieces.push(',');\n            }\n\n            // There should be an extract function for the named type\n            if (!this.extract[this.type]) {\n                return null;\n            }\n\n            data = this.extract[this.type].apply(this, [components[i]]);\n            if (this.isCollection() && this.type !== 'multipoint') {\n                pieces.push('(' + data + ')');\n\n            } else {\n                pieces.push(data);\n\n                // If not at the end of the components, add a comma\n                if (i !== (components.length - 1) && this.type !== 'multipoint') {\n                    pieces.push(',');\n                }\n\n            }\n        }\n\n        pieces.push(')');\n\n        return pieces.join('');\n    };\n\n    /**\n     * This object contains functions as property names that extract WKT\n     * strings from the internal representation.\n     * @memberof this.Wkt.Wkt\n     * @namespace this.Wkt.Wkt.extract\n     * @instance\n     */\n    Wkt.Wkt.prototype.extract = {\n        /**\n         * Return a WKT string representing atomic (point) geometry\n         * @param   point   {Object}    An object with x and y properties\n         * @return          {String}    The WKT representation\n         * @memberof this.Wkt.Wkt.extract\n         * @instance\n         */\n        point: function (point) {\n            return String(point.x) + this.delimiter + String(point.y);\n        },\n\n        /**\n         * Return a WKT string representing multiple atoms (points)\n         * @param   multipoint  {Array}     Multiple x-and-y objects\n         * @return              {String}    The WKT representation\n         * @memberof this.Wkt.Wkt.extract\n         * @instance\n         */\n        multipoint: function (multipoint) {\n            var i, parts = [],\n                s;\n\n            for (i = 0; i < multipoint.length; i += 1) {\n                s = this.extract.point.apply(this, [multipoint[i]]);\n\n                if (this.wrapVertices) {\n                    s = '(' + s + ')';\n                }\n\n                parts.push(s);\n            }\n\n            return parts.join(',');\n        },\n\n        /**\n         * Return a WKT string representing a chain (linestring) of atoms\n         * @param   linestring  {Array}     Multiple x-and-y objects\n         * @return              {String}    The WKT representation\n         * @memberof this.Wkt.Wkt.extract\n         * @instance\n         */\n        linestring: function (linestring) {\n            // Extraction of linestrings is the same as for points\n            return this.extract.point.apply(this, [linestring]);\n        },\n\n        /**\n         * Return a WKT string representing multiple chains (multilinestring) of atoms\n         * @param   multilinestring {Array}     Multiple of multiple x-and-y objects\n         * @return                  {String}    The WKT representation\n         * @memberof this.Wkt.Wkt.extract\n         * @instance\n         */\n        multilinestring: function (multilinestring) {\n            var i, parts = [];\n\n            if (multilinestring.length) {\n                for (i = 0; i < multilinestring.length; i += 1) {\n                    parts.push(this.extract.linestring.apply(this, [multilinestring[i]]));\n                }\n            } else {\n                parts.push(this.extract.point.apply(this, [multilinestring]));\n            }\n\n            return parts.join(',');\n        },\n\n        /**\n         * Return a WKT string representing multiple atoms in closed series (polygon)\n         * @param   polygon {Array}     Collection of ordered x-and-y objects\n         * @return          {String}    The WKT representation\n         * @memberof this.Wkt.Wkt.extract\n         * @instance\n         */\n        polygon: function (polygon) {\n            // Extraction of polygons is the same as for multilinestrings\n            return this.extract.multilinestring.apply(this, [polygon]);\n        },\n\n        /**\n         * Return a WKT string representing multiple closed series (multipolygons) of multiple atoms\n         * @param   multipolygon    {Array}     Collection of ordered x-and-y objects\n         * @return                  {String}    The WKT representation\n         * @memberof this.Wkt.Wkt.extract\n         * @instance\n         */\n        multipolygon: function (multipolygon) {\n            var i, parts = [];\n            for (i = 0; i < multipolygon.length; i += 1) {\n                parts.push('(' + this.extract.polygon.apply(this, [multipolygon[i]]) + ')');\n            }\n            return parts.join(',');\n        },\n\n        /**\n         * Return a WKT string representing a 2DBox\n         * @param   multipolygon    {Array}     Collection of ordered x-and-y objects\n         * @return                  {String}    The WKT representation\n         * @memberof this.Wkt.Wkt.extract\n         * @instance\n         */\n        box: function (box) {\n            return this.extract.linestring.apply(this, [box]);\n        },\n\n        geometrycollection: function (str) {\n            console.log('The geometrycollection WKT type is not yet supported.');\n        }\n    };\n\n    /**\n     * This object contains functions as property names that ingest WKT\n     * strings into the internal representation.\n     * @memberof this.Wkt.Wkt\n     * @namespace this.Wkt.Wkt.ingest\n     * @instance\n     */\n    Wkt.Wkt.prototype.ingest = {\n\n        /**\n         * Return point feature given a point WKT fragment.\n         * @param   str {String}    A WKT fragment representing the point\n         * @memberof this.Wkt.Wkt.ingest\n         * @instance\n         */\n        point: function (str) {\n            var coords = Wkt.trim(str).split(this.regExes.spaces);\n            // In case a parenthetical group of coordinates is passed...\n            return [{ // ...Search for numeric substrings\n                x: parseFloat(this.regExes.numeric.exec(coords[0])[0]),\n                y: parseFloat(this.regExes.numeric.exec(coords[1])[0])\n            }];\n        },\n\n        /**\n         * Return a multipoint feature given a multipoint WKT fragment.\n         * @param   str {String}    A WKT fragment representing the multipoint\n         * @memberof this.Wkt.Wkt.ingest\n         * @instance\n         */\n        multipoint: function (str) {\n            var i, components, points;\n            components = [];\n            points = Wkt.trim(str).split(this.regExes.comma);\n            for (i = 0; i < points.length; i += 1) {\n                components.push(this.ingest.point.apply(this, [points[i]]));\n            }\n            return components;\n        },\n\n        /**\n         * Return a linestring feature given a linestring WKT fragment.\n         * @param   str {String}    A WKT fragment representing the linestring\n         * @memberof this.Wkt.Wkt.ingest\n         * @instance\n         */\n        linestring: function (str) {\n            var i, multipoints, components;\n\n            // In our x-and-y representation of components, parsing\n            //  multipoints is the same as parsing linestrings\n            multipoints = this.ingest.multipoint.apply(this, [str]);\n\n            // However, the points need to be joined\n            components = [];\n            for (i = 0; i < multipoints.length; i += 1) {\n                components = components.concat(multipoints[i]);\n            }\n            return components;\n        },\n\n        /**\n         * Return a multilinestring feature given a multilinestring WKT fragment.\n         * @param   str {String}    A WKT fragment representing the multilinestring\n         * @memberof this.Wkt.Wkt.ingest\n         * @instance\n         */\n        multilinestring: function (str) {\n            var i, components, line, lines;\n            components = [];\n\n            lines = Wkt.trim(str).split(this.regExes.doubleParenComma);\n            if (lines.length === 1) { // If that didn't work...\n                lines = Wkt.trim(str).split(this.regExes.parenComma);\n            }\n\n            for (i = 0; i < lines.length; i += 1) {\n                line = this._stripWhitespaceAndParens(lines[i]);\n                components.push(this.ingest.linestring.apply(this, [line]));\n            }\n\n            return components;\n        },\n\n        /**\n         * Return a polygon feature given a polygon WKT fragment.\n         * @param   str {String}    A WKT fragment representing the polygon\n         * @memberof this.Wkt.Wkt.ingest\n         * @instance\n         */\n        polygon: function (str) {\n            var i, j, components, subcomponents, ring, rings;\n            rings = Wkt.trim(str).split(this.regExes.parenComma);\n            components = []; // Holds one or more rings\n            for (i = 0; i < rings.length; i += 1) {\n                ring = this._stripWhitespaceAndParens(rings[i]).split(this.regExes.comma);\n                subcomponents = []; // Holds the outer ring and any inner rings (holes)\n                for (j = 0; j < ring.length; j += 1) {\n                    // Split on the empty space or '+' character (between coordinates)\n                    var split = ring[j].split(this.regExes.spaces);\n                    if (split.length > 2) {\n                        //remove the elements which are blanks\n                        split = split.filter(function (n) {\n                            return n != \"\"\n                        });\n                    }\n                    if (split.length === 2) {\n                        var x_cord = split[0];\n                        var y_cord = split[1];\n\n                        //now push\n                        subcomponents.push({\n                            x: parseFloat(x_cord),\n                            y: parseFloat(y_cord)\n                        });\n                    }\n                }\n                components.push(subcomponents);\n            }\n            return components;\n        },\n\n        /**\n         * Return box vertices (which would become the Rectangle bounds) given a Box WKT fragment.\n         * @param   str {String}    A WKT fragment representing the box\n         * @memberof this.Wkt.Wkt.ingest\n         * @instance\n         */\n        box: function (str) {\n            var i, multipoints, components;\n\n            // In our x-and-y representation of components, parsing\n            //  multipoints is the same as parsing linestrings\n            multipoints = this.ingest.multipoint.apply(this, [str]);\n\n            // However, the points need to be joined\n            components = [];\n            for (i = 0; i < multipoints.length; i += 1) {\n                components = components.concat(multipoints[i]);\n            }\n\n            return components;\n        },\n\n        /**\n         * Return a multipolygon feature given a multipolygon WKT fragment.\n         * @param   str {String}    A WKT fragment representing the multipolygon\n         * @memberof this.Wkt.Wkt.ingest\n         * @instance\n         */\n        multipolygon: function (str) {\n            var i, components, polygon, polygons;\n            components = [];\n            polygons = Wkt.trim(str).split(this.regExes.doubleParenComma);\n            for (i = 0; i < polygons.length; i += 1) {\n                polygon = this._stripWhitespaceAndParens(polygons[i]);\n                components.push(this.ingest.polygon.apply(this, [polygon]));\n            }\n            return components;\n        },\n\n        /**\n         * Return an array of features given a geometrycollection WKT fragment.\n         * @param   str {String}    A WKT fragment representing the geometry collection\n         * @memberof this.Wkt.Wkt.ingest\n         * @instance\n         */\n        geometrycollection: function (str) {\n            console.log('The geometrycollection WKT type is not yet supported.');\n        }\n\n    }; // eo ingest\n\n    return Wkt;\n}));\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAVNSURBVHgB1ZpNbBtVEMdn3q7t2g2SQ6T2UBAmUrmRpidyw4YcqiaiRSAhIaEWECJNhZpIXCqhNoED3OoKKY1UqaQXuICUSk3hAMScaE847Y1K1IdeWqmtJfJpZ3eYef5gndjZrzhxflJkO377/P47M+/Nm7cI28TKyLGUBZBWhnGEP6aBKEmASQRI/t+KCohYIIC8TbRQtu1c9/QvBdgGEELwbCyd3FdKnOOBneauUhCMAo9ids2yLocRFUjIvyPH0qZhXCTiO7+N8A2ZKdnWZBBBvoQ8Y/eJonkJkU5CGwkiyLOQ5dFhdiGaaPT5tlKwgSa7pm7NeGnsScjy2aFLfJvGYDcgyCauzI27NdtSiARzrLR/nt/2w+6SX4suZbqzuWKrBi2FdJCIGluKUa2u6jARQn91TE1pKkTHRGeJqNG/fEaPbRObXGtx5PhppfA78IF6oRfw0MtgvNgL0HMQ1KHeSuc9Bxra0ZPHnAIsAq0sAT38Byz+o4cPwOZXX5A9nrjycxZaCZF1IqYMMV/KrS98/gBE3jgB6rVBwMR+CIMItO/fhfLcD0BPH3m5pLhmW0ed64zp/DaqjIvgIgLj+8Eceh/MzAnYLsRyRs8gGAODsD5/A8o/XnW7JBlDJS72dr2P2puqNR649RD9YEz/YDux79+Dtex513aWjZnnpm/m5H092KvW2BKxRrtFCOrwq2ylg67tTKT6mLVriTVQZ7AuNIkFCVx74U8Ig3qlT8ecXwghLeudrC1aSESpQOkHPX0Ma19/BrS8BGEQS8e+uqZf/RItJWTsE9q1FKBr5CJPqWa6sZn9993QIgSxqrXBqmbmLbaSu3sh4CndXtwKPEy3sU+/2LQutBOZFSUeVz9/z61pis4ef0lFQKXBAzspov6bHl1tiSCj2K86MRXxS78yEI/AHodj/HVFRCnY+yRViOpHJ5FUXluu/34DdhrJuzziXUj5p6uweuGjhv95SSO8ohJdDZ9XL3zsJXmsY3LppRi0MiI5kcmpvLVwG8JgDrwJqm8AwmAiEO+BMXCJJ/LOJ/pvlykoQizCHgdRhBD9AQHRmS/vHSR5DNOHuGaYPiwuiJtgQx48h7xjAJL58uaHnjzS6Uts7Bvfqbgze9Z9nP82UAbM5JUBdg4CIAUDEaEHxHtuizNh3304smfpg/wWIaoYfDyh4noDTwXwid7FOe6ecbgP/CLVlxpiTS9pexMKokFvrHgKvs5TsOtW14neDLErSPVDl4MCZMfI1+378lqlD74RQfrgQrdeNbWQUjSajZXKvoTogVSrH2EI2we7la5v6TDvzs4WkSDndlGl/nQP2o1MArX42wr2opl4tbZVr2utE04aSGm3i2Wmkt1b5N3Ni6DkRl5XeYmxCNfHNlLitMS+8yt4gg+Dam/rQqQ+tHxmeBY8nEa1KnHaUv70aLFWU7XMXF7qAE5rCA0rCNL6uORerr2sNP8h4rruDlFwWkNoECIKOVYm3XoRi2xM68USto/k0brzG6zfbnSh8q3vPVlUjuTiG84Xmx70LI4OZxXQOehAWMRlPlfcVIdreWK1NDr0F3beGUk+MTV3tNkXLbOsUjSSkScUoHPIx/nordWXLoehJ5PRUnm+AyyjRWCQw1AnuxkzrWJiI54S+K6pm2O2TR+CTHs7hF4GCMa9iBB8PcIhTwDZaEzwjuwUtBPCWVnT4u14hMNJ2wQh5CwLJ2unUP4uDYEIIn22oo8lUhAIKhCo64noYnarYHYjlBAnlQfPVFpxURy5nlwpxWKq9n2l7ERFKXYg1wls3mIbEM3Fp2cLsA38B3RbKi3vmuGCAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAACZ3F9/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAECSURBVHgBnZK9rgFBFMfPmeHmJrfZR9jm3txoKOhXR7eJB6Ck8wbolDQbneh9FSvRoZPQaERoPAIdydpjZnxkIzaWf3HOmcz8cuZ8IHhkmEXtJ3TMMcQoEeqAtCOiycmh/rDf2Hrf4i1IZwomR2yKUIPnKtttq3I7cA/UE+E3+Mv4iyRgvZxNVMaUmdfDnI0IQYdAcpN2uzFmLAxGcEjlKknLGPEsvCWMKRD8m+En7QIibeEDMSBYvEUAjhUYcr5qwu+CYq5LLen5ajU9/EbiRxSTeUkR1Addq6pAaTbL+VTAeyD8R/RploDsjlW8f9h7J5dBzvU6Ik2VQLRwTm7tcVfPJ5RRi4CX2gMAAAAASUVORK5CYII=\"","<template>\r\n  <div class=\"bus-driving-map\">\r\n    <BreadcrumbBar\r\n      :navbar-style=\"navbarStyle\"\r\n      :routeData=\"routeData\"\r\n    ></BreadcrumbBar>\r\n    <div class=\"bus-title bg-primary\">\r\n      <div class=\"container d-flex justify-content-between px-3 px-sm-5\">\r\n        <div class=\"d-flex flex-column justify-content-end\">\r\n          <button\r\n            class=\"btn icon-btn\"\r\n            @click=\"this.$refs.timetableModal.show()\"\r\n          >\r\n            <div class=\"rounded-pill bg-info\">\r\n              <i\r\n                class=\"\r\n                  fas\r\n                  fa-clock\r\n                  position-absolute\r\n                  top-50\r\n                  start-50\r\n                  translate-middle\r\n                \"\r\n              ></i>\r\n            </div>\r\n            <span class=\"ms-2 d-none d-sm-block\">公車時刻表</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"text-end\">\r\n          <h1 class=\"mb-1\">{{ routeName }}</h1>\r\n          <span\r\n            >{{ routeData.DepartureStopNameZh\r\n            }}<i class=\"fas fa-arrows-alt-h mx-1\"></i\r\n            >{{ routeData.DestinationStopNameZh }}</span\r\n          >\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"bg-primary\">\r\n      <div class=\"bus-information bg-white\">\r\n        <div class=\"container\">\r\n          <div class=\"row gx-0 gy-2\">\r\n            <div class=\"col-lg-6 d-none d-sm-block\">\r\n              <div class=\"realtime-data px-3 px-sm-5\">\r\n                <div class=\"d-flex justify-content-between py-3 border-bottom\">\r\n                  <div class=\"text-dark\">\r\n                    <span class=\"text-muted fs-7\">行駛方向</span> <br />\r\n                    <span class=\"text-info me-2\">往</span>\r\n                    <span v-if=\"!busDirection\">{{\r\n                      routeData.DestinationStopNameZh\r\n                    }}</span>\r\n                    <span v-else>{{ routeData.DepartureStopNameZh }}</span>\r\n                  </div>\r\n                  <button\r\n                    v-if=\"hasBothDirection\"\r\n                    class=\"btn icon-btn\"\r\n                    @click=\"busDirectionHandler\"\r\n                  >\r\n                    <div class=\"rounded-pill bg-info\">\r\n                      <i\r\n                        class=\"\r\n                          fas fas\r\n                          fa-exchange-alt\r\n                          position-absolute\r\n                          top-50\r\n                          start-50\r\n                          translate-middle\r\n                        \"\r\n                      ></i>\r\n                    </div>\r\n                  </button>\r\n                </div>\r\n                <div class=\"stop-container mt-3 pe-3\">\r\n                  <div\r\n                    v-for=\"stop in tempRealtimeData\"\r\n                    :key=\"stop.StopID\"\r\n                    class=\"stop-item d-flex justify-content-between mb-3\"\r\n                  >\r\n                    <span>{{ stop.stopName }}</span>\r\n                    <span>{{ stop.estimateTime }}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-lg-6\">\r\n              <div id=\"map\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"collapse-realtime-data d-sm-none\">\r\n      <button\r\n        class=\"btn w-100\"\r\n        type=\"button\"\r\n        data-bs-toggle=\"collapse\"\r\n        data-bs-target=\"#realtime-data\"\r\n        aria-expanded=\"false\"\r\n        aria-controls=\"realtime-data\"\r\n        @click=\"collapseShow = !collapseShow\"\r\n      >\r\n        <span v-if=\"collapseShow\"\r\n          ><i class=\"fas fa-chevron-left me-1\"></i> 查看地圖</span\r\n        >\r\n        <i v-else class=\"fas fa-caret-up\"></i>\r\n      </button>\r\n      <div\r\n        id=\"realtime-data\"\r\n        class=\"realtime-data collapse px-3 px-sm-5\"\r\n        :class=\"{ 'd-none': !collapseShow }\"\r\n      >\r\n        <div class=\"d-flex justify-content-between py-3 border-bottom\">\r\n          <div class=\"text-dark\">\r\n            <span class=\"text-muted fs-7\">行駛方向</span> <br />\r\n            <span class=\"text-info me-2\">往</span>\r\n            <span v-if=\"!busDirection\">{{\r\n              routeData.DestinationStopNameZh\r\n            }}</span>\r\n            <span v-else>{{ routeData.DepartureStopNameZh }}</span>\r\n          </div>\r\n          <button\r\n            v-if=\"hasBothDirection\"\r\n            class=\"btn icon-btn\"\r\n            @click=\"busDirectionHandler\"\r\n          >\r\n            <div class=\"rounded-pill bg-info\">\r\n              <i class=\"fas fas fa-exchange-alt\"></i>\r\n            </div>\r\n          </button>\r\n        </div>\r\n        <div class=\"stop-container mt-3 pe-3\">\r\n          <div\r\n            v-for=\"stop in tempRealtimeData\"\r\n            :key=\"stop.StopID\"\r\n            class=\"stop-item d-flex justify-content-between mb-3\"\r\n          >\r\n            <span>{{ stop.stopName }}</span>\r\n            <span>{{ stop.estimateTime }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <TimetableModal :bus=\"routeData\" ref=\"timetableModal\"></TimetableModal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport BreadcrumbBar from '@/components/BreadcrumbBar.vue'\r\nimport TimetableModal from '@/components/TimetableModal.vue'\r\nimport L from 'leaflet'\r\nimport Wkt from 'wicket'\r\nimport getAuthorizationHeader from '@/methods/getAuthorizationHeader'\r\n\r\nexport default {\r\n  components: { BreadcrumbBar, TimetableModal },\r\n  data () {\r\n    return {\r\n      navbarStyle: 'light',\r\n      collapseShow: false,\r\n      city: '',\r\n      routeName: '',\r\n      routeData: {},\r\n      busTimetables: [],\r\n      busRoute: [],\r\n      busLocation: [],\r\n      busStop: [],\r\n      tempStops: [],\r\n      realtimeData: [],\r\n      hasBothDirection: '',\r\n      busDirection: 0,\r\n      map: {},\r\n      routeLayer: null,\r\n      stopLayer: null,\r\n      busLayer: null\r\n    }\r\n  },\r\n  computed: {\r\n    tempRealtimeData () {\r\n      const realtimeData = this.realtimeData.filter(\r\n        (item) => item.Direction === this.busDirection\r\n      )\r\n      const newData = this.tempStops.map((item) => ({\r\n        stopName: item.StopName.Zh_tw,\r\n        stopUID: item.StopUID,\r\n        stopSequence: item.StopSequence,\r\n        plateNumb: '--',\r\n        estimateTime: '--'\r\n      }))\r\n      realtimeData.forEach((data) => {\r\n        newData.forEach((newData) => {\r\n          if (data.StopUID === newData.stopUID) {\r\n            newData.plateNumb = data.PlateNumb\r\n            const options = {\r\n              day: 'numeric',\r\n              month: 'numeric',\r\n              year: 'numeric',\r\n              hour: '2-digit',\r\n              minute: '2-digit',\r\n              hour12: false,\r\n              timeZone: 'Asia/Taipei'\r\n            }\r\n            const NextBusTime = new Date(data.NextBusTime).toLocaleTimeString(\r\n              'en-US',\r\n              options\r\n            )\r\n            if (data.StopStatus === 0) {\r\n              const time = Math.floor(data.EstimateTime / 60)\r\n              if (time === 0) {\r\n                newData.estimateTime = '進站中'\r\n              } else if (time <= 1 && time > 0) {\r\n                newData.estimateTime = '即將到站'\r\n              } else if (!time) {\r\n                newData.estimateTime = '--'\r\n              } else {\r\n                newData.estimateTime = `${time}分鐘`\r\n              }\r\n            } else if (data.StopStatus === 1) {\r\n              newData.estimateTime = data.NextBusTime ? NextBusTime : '尚未發車'\r\n            } else if (data.StopStatus === 2) {\r\n              newData.estimateTime = '交管不停靠'\r\n            } else if (data.StopStatus === 3) {\r\n              newData.estimateTime = data.NextBusTime\r\n                ? NextBusTime\r\n                : '末班車已過'\r\n            } else if (data.StopStatus === 4) {\r\n              newData.estimateTime = '今日未營運'\r\n            } else {\r\n              newData.estimateTime = '--'\r\n            }\r\n          }\r\n        })\r\n      })\r\n      return newData\r\n    }\r\n  },\r\n  watch: {\r\n    busDirection () {\r\n      this.drawRoute()\r\n      this.drawStop()\r\n      this.drawBus()\r\n    }\r\n  },\r\n  inject: ['emitter'],\r\n  methods: {\r\n    initialMap () {\r\n      this.map = L.map('map', { zoomControl: false }).setView([0, 0], 0)\r\n      L.tileLayer(\r\n        `https://{s}.tile.jawg.io/jawg-light/{z}/{x}/{y}{r}.png?access-token=${process.env.VUE_APP_JAWG_ACCESSTOKEN}`,\r\n        {\r\n          attribution:\r\n            '<a href=\"http://jawg.io\" title=\"Tiles Courtesy of Jawg Maps\" target=\"_blank\">&copy; <b>Jawg</b>Maps</a> &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n          minZoom: 0,\r\n          maxZoom: 22,\r\n          subdomains: 'abcd',\r\n          accessToken: process.env.VUE_APP_JAWG_ACCESSTOKEN\r\n        }\r\n      ).addTo(this.map)\r\n      this.getRouteData()\r\n      this.getShapeData()\r\n      this.getStop()\r\n      this.getRealtimeData()\r\n      this.getBusLocation()\r\n      this.getBusTimetable()\r\n    },\r\n    getRouteData () {\r\n      this.axios({\r\n        method: 'get',\r\n        url: `https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/${this.city}/${this.routeName}?$format=JSON`,\r\n        headers: getAuthorizationHeader()\r\n      }).then((res) => {\r\n        this.routeData = res.data.find(\r\n          (item) => item.RouteName.Zh_tw === this.routeName\r\n        )\r\n      })\r\n    },\r\n    getRealtimeData () {\r\n      this.axios({\r\n        method: 'get',\r\n        url: `https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/${this.city}/${this.routeName}?$format=JSON`,\r\n        headers: getAuthorizationHeader()\r\n      }).then((res) => {\r\n        this.realtimeData = res.data.filter(\r\n          (item) => item.RouteName.Zh_tw === this.routeName\r\n        )\r\n        const go = this.realtimeData.filter((item) => item.Direction === 0)\r\n        const back = this.realtimeData.filter((item) => item.Direction === 1)\r\n        if (go.length && back.length) {\r\n          this.hasBothDirection = true\r\n        } else {\r\n          this.hasBothDirection = false\r\n        }\r\n      })\r\n    },\r\n    getShapeData () {\r\n      this.axios({\r\n        method: 'get',\r\n        url: `https://ptx.transportdata.tw/MOTC/v2/Bus/Shape/City/${this.city}/${this.routeName}?$format=JSON`,\r\n        headers: getAuthorizationHeader()\r\n      }).then((res) => {\r\n        this.busRoute = res.data.filter(\r\n          (item) => item.RouteName.Zh_tw === this.routeName\r\n        )\r\n        this.drawRoute()\r\n      })\r\n    },\r\n    drawRoute () {\r\n      if (this.routeLayer) {\r\n        this.map.removeLayer(this.routeLayer)\r\n      }\r\n      const line = this.busRoute.find(\r\n        (item) => item.Direction === this.busDirection\r\n      )\r\n      const geo = line ? line.Geometry : this.busRoute[0].Geometry\r\n      const wicket = new Wkt.Wkt()\r\n      const geojsonFeature = wicket.read(geo).toJson()\r\n      this.routeLayer = L.geoJSON(geojsonFeature, {\r\n        style: {\r\n          color: '#5CBCDB',\r\n          weight: 4\r\n        }\r\n      }).addTo(this.map)\r\n      this.map.fitBounds(this.routeLayer.getBounds())\r\n    },\r\n    getBusLocation () {\r\n      this.axios({\r\n        method: 'get',\r\n        url: `https://ptx.transportdata.tw/MOTC/v2/Bus/RealTimeByFrequency/City/${this.city}/${this.routeName}?$format=JSON`,\r\n        headers: getAuthorizationHeader()\r\n      }).then((res) => {\r\n        this.busLocation = res.data.filter(\r\n          (item) => item.RouteName.Zh_tw === this.routeName\r\n        )\r\n        this.drawBus()\r\n      })\r\n    },\r\n    drawBus () {\r\n      const icon = L.icon({\r\n        iconUrl: require('@/assets/images/bus.png'),\r\n        iconSize: [30, 30]\r\n      })\r\n      if (this.busLayer) {\r\n        this.map.removeLayer(this.busLayer)\r\n      }\r\n      const bus = this.busLocation.filter(\r\n        (item) => item.Direction === this.busDirection\r\n      )\r\n      this.busLayer = L.layerGroup().addTo(this.map)\r\n      bus.forEach((item) => {\r\n        const lat = item.BusPosition.PositionLat\r\n        const lon = item.BusPosition.PositionLon\r\n        L.marker([lat, lon], {\r\n          icon: icon,\r\n          title: item.PlateNumb,\r\n          opacity: 1.0\r\n        })\r\n          .setZIndexOffset(100)\r\n          .addTo(this.busLayer)\r\n      })\r\n    },\r\n    getStop () {\r\n      this.axios({\r\n        method: 'get',\r\n        url: `https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/${this.city}/${this.routeName}?$format=JSON`,\r\n        headers: getAuthorizationHeader()\r\n      }).then((res) => {\r\n        this.busStop = res.data.filter(\r\n          (item) => item.RouteName.Zh_tw === this.routeName\r\n        )\r\n        this.drawStop()\r\n      })\r\n    },\r\n    drawStop () {\r\n      const icon = L.icon({\r\n        iconUrl: require('@/assets/images/stop.png'),\r\n        iconSize: [10, 10]\r\n      })\r\n      if (this.stopLayer) {\r\n        this.map.removeLayer(this.stopLayer)\r\n      }\r\n      this.tempStops = this.busStop.find(\r\n        (item) => item.Direction === this.busDirection\r\n      ).Stops\r\n      this.stopLayer = L.layerGroup().addTo(this.map)\r\n      this.tempStops.forEach((item) => {\r\n        const lat = item.StopPosition.PositionLat\r\n        const lon = item.StopPosition.PositionLon\r\n        L.marker([lat, lon], {\r\n          icon: icon,\r\n          title: item.StopName.Zh_tw,\r\n          opacity: 1.0\r\n        }).addTo(this.stopLayer)\r\n      })\r\n    },\r\n    busDirectionHandler () {\r\n      if (this.busDirection) {\r\n        this.busDirection = 0\r\n      } else {\r\n        this.busDirection = 1\r\n      }\r\n    },\r\n    getBusTimetable () {\r\n      this.axios({\r\n        method: 'get',\r\n        url: `https://ptx.transportdata.tw/MOTC/v2/Bus/Schedule/City/${this.city}/${this.routeName}?$format=JSON`,\r\n        headers: getAuthorizationHeader()\r\n      }).then((res) => {\r\n        this.busTimetables = res.data.filter(\r\n          (item) => item.RouteName.Zh_tw === this.routeName\r\n        )\r\n        // 整理 timetable\r\n        this.routeData.Timetables = {}\r\n        const newTimetables = []\r\n        this.busTimetables.forEach((item) => {\r\n          if (item.Timetables) {\r\n            const data = {\r\n              subRouteName: item.SubRouteName.Zh_tw,\r\n              direction: item.Direction,\r\n              timetable: []\r\n            }\r\n            item.Timetables.forEach((timetable) => {\r\n              if (timetable.ServiceDay && timetable.StopTimes) {\r\n                const time = timetable.StopTimes.find(\r\n                  (item) => item.StopSequence === 1\r\n                ).DepartureTime\r\n                const index = data.timetable\r\n                  .map((item) => item.departureTime)\r\n                  .indexOf(time)\r\n                if (index === -1) {\r\n                  data.timetable.push({\r\n                    departureTime: time,\r\n                    serviceDay: { ...timetable.ServiceDay }\r\n                  })\r\n                } else {\r\n                  const days = Object.keys(timetable.ServiceDay).filter(\r\n                    (day) => timetable.ServiceDay[day] === 1\r\n                  )\r\n                  days.forEach((day) => {\r\n                    data.timetable[index].serviceDay[day] = 1\r\n                  })\r\n                }\r\n              }\r\n            })\r\n            // 依照時間排序\r\n            data.timetable.sort((a, b) => {\r\n              return (\r\n                a.departureTime.split(':').join('') -\r\n                b.departureTime.split(':').join('')\r\n              )\r\n            })\r\n            newTimetables.push(data)\r\n          }\r\n        })\r\n        // 拆分平日與假日 timetable\r\n        const holidayTimetable = newTimetables.map((item) => ({\r\n          ...item,\r\n          serviceDay: 'holiday',\r\n          timetable: item.timetable.filter(\r\n            (item) =>\r\n              item.serviceDay.Saturday === 1 && item.serviceDay.Sunday === 1\r\n          )\r\n        })).filter(item => item.timetable.length)\r\n        this.routeData.Timetables.holiday = holidayTimetable\r\n        const commonTimetable = newTimetables.map((item) => ({\r\n          ...item,\r\n          serviceDay: 'common',\r\n          timetable: item.timetable.filter(\r\n            (item) =>\r\n              item.serviceDay.Monday === 1 &&\r\n              item.serviceDay.Tuesday === 1 &&\r\n              item.serviceDay.Wednesday === 1 &&\r\n              item.serviceDay.Thursday === 1 &&\r\n              item.serviceDay.Friday === 1\r\n          )\r\n        })).filter(item => item.timetable.length)\r\n        this.routeData.Timetables.common = commonTimetable\r\n        // 整理 frequency (含去回程、子路線、不同站發車)\r\n        this.routeData.Frequencys = {}\r\n        const newFrequencys = []\r\n        this.busTimetables.forEach((item) => {\r\n          if (item.Frequencys) {\r\n            const data = {\r\n              subRouteName: item.SubRouteName.Zh_tw,\r\n              direction: item.Direction,\r\n              frequency: []\r\n            }\r\n            item.Frequencys.forEach((frequency) => {\r\n              const timePeriod = `${frequency.StartTime} - ${frequency.EndTime}`\r\n              const index = data.frequency\r\n                .map((item) => item.timePeriod)\r\n                .indexOf(timePeriod)\r\n              if (index === -1) {\r\n                data.frequency.push({\r\n                  timePeriod: timePeriod,\r\n                  startTime: frequency.StartTime,\r\n                  endTime: frequency.EndTime,\r\n                  minHeadwayMins: frequency.MinHeadwayMins,\r\n                  maxHeadwayMins: frequency.MaxHeadwayMins,\r\n                  serviceDay: { ...frequency.ServiceDay }\r\n                })\r\n              } else {\r\n                const days = Object.keys(frequency.ServiceDay).filter(\r\n                  (day) => frequency.ServiceDay[day] === 1\r\n                )\r\n                days.forEach((day) => {\r\n                  data.frequency[index].serviceDay[day] = 1\r\n                })\r\n              }\r\n            })\r\n            newFrequencys.push(data)\r\n          }\r\n        })\r\n        // 拆分平日與假日 frequency\r\n        const holidayFrequency = newFrequencys.map((item) => ({\r\n          ...item,\r\n          serviceDay: 'holiday',\r\n          frequency: item.frequency.filter(\r\n            (item) =>\r\n              item.serviceDay.Saturday === 1 && item.serviceDay.Sunday === 1\r\n          )\r\n        }))\r\n        this.routeData.Frequencys.holiday = holidayFrequency\r\n        const commonFrequency = newFrequencys.map((item) => ({\r\n          ...item,\r\n          serviceDay: 'common',\r\n          frequency: item.frequency.filter(\r\n            (item) =>\r\n              item.serviceDay.Monday === 1 &&\r\n              item.serviceDay.Tuesday === 1 &&\r\n              item.serviceDay.Wednesday === 1 &&\r\n              item.serviceDay.Thursday === 1 &&\r\n              item.serviceDay.Friday === 1\r\n          )\r\n        }))\r\n        this.routeData.Frequencys.common = commonFrequency\r\n      })\r\n    }\r\n  },\r\n  created () {\r\n    this.emitter.emit('change-navbar-style', this.navbarStyle)\r\n    this.city = this.$route.query.city\r\n    this.routeName = this.$route.query.routeName\r\n  },\r\n  mounted () {\r\n    this.initialMap()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '~bootstrap/scss/functions';\r\n@import '../assets/style/custom/_variables.scss';\r\n@import '~bootstrap/scss/variables';\r\n@import '~bootstrap/scss/mixins';\r\n@import '~bootstrap/scss/utilities';\r\n\r\n.bus-driving-map {\r\n  .container {\r\n    padding: 0;\r\n  }\r\n}\r\n.bus-title {\r\n  margin-top: 110px;\r\n  border-radius: 20px 20px 0 0;\r\n  padding: 20px 0 12px 0;\r\n  color: #ffffff;\r\n  text-align: center;\r\n  @include media-breakpoint-down(md) {\r\n    margin-top: 90px;\r\n  }\r\n}\r\n.bus-information {\r\n  border-radius: 20px 20px 0 0;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  @include media-breakpoint-down(sm) {\r\n    border-radius: 0;\r\n  }\r\n}\r\n#map {\r\n  height: 500px;\r\n  @include media-breakpoint-down(sm) {\r\n    height: calc(100vh - 192px);\r\n  }\r\n}\r\n.realtime-data {\r\n  height: 500px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  @include media-breakpoint-down(sm) {\r\n    height: calc(100vh - 100px);\r\n  }\r\n}\r\n.collapse-realtime-data {\r\n  background-color: #ffffff;\r\n  position: fixed;\r\n  bottom: 0;\r\n  width: 100%;\r\n  z-index: 500;\r\n  border-top-left-radius: 20px;\r\n  border-top-right-radius: 20px;\r\n  box-shadow: 0px 2px 12px rgba(0, 0, 0, 0.15);\r\n}\r\n.stop-container {\r\n  overflow: auto;\r\n}\r\n</style>\r\n","import { render } from \"./BusDrivingMap.vue?vue&type=template&id=f25e0d52&scoped=true\"\nimport script from \"./BusDrivingMap.vue?vue&type=script&lang=js\"\nexport * from \"./BusDrivingMap.vue?vue&type=script&lang=js\"\n\nimport \"./BusDrivingMap.vue?vue&type=style&index=0&id=f25e0d52&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\The F2E 3rd\\\\hello-bus\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-f25e0d52\"]])\n\nexport default __exports__","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./BusDrivingMap.vue?vue&type=style&index=0&id=f25e0d52&lang=scss&scoped=true\""],"sourceRoot":""}